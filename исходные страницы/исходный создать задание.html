<!DOCTYPE html>
<!-- saved from url=(0036)http://localhost:51381/Claims/Create -->
<html style="" class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home Page – приложение ASP.NET</title>
    <link href="./исходный создать задание_files/bootstrap.css" rel="stylesheet">
<link href="./исходный создать задание_files/site.css" rel="stylesheet">

    <script src="./исходный создать задание_files/modernizr-2.8.3.js.Без названия"></script>

</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://localhost:51381/">Имя приложения</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="http://localhost:51381/Registration">Регистрация</a></li>
                    <li><a href="http://localhost:51381/Authorization">Войти на сайт</a></li>
                    <li><a href="http://localhost:51381/">Домашняя страница</a></li>
                    <li><a href="http://localhost:51381/Home/About">О программе</a></li>
                    <li><a href="http://localhost:51381/Home/Contact">Контакт</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container body-content">
        


<div class="logged-in-user">
    <h1>Новое задание</h1>
    <h5 class="logged-in">
        Логист <b>
            Ivan
            Ivanov
        </b>
    </h5>
    <a href="http://localhost:51381/Authorization">Выйти</a>
</div>
<form id="assign-claim">
    <input type="radio" name="assign" value="shipper" checked="">Назначить на перевозчика<br>
    <input type="radio" name="assign" value="trading">Распределить на торги/по рейтингу/с свободный доступ
</form>
<form action="http://localhost:51381/Claims/SaveCreated" class="claim">
    <div class="row">
        <div class="col-lg-6">
            <input id="logistian-id" type="hidden" name="logistianId" value="1">

            <label class="lbl">Номер</label>
            <input type="text" name="number" id="number" class="form-control">

            <label class="date-lbl lbl">Дата заполнения</label>
            <input type="text" name="date" class="form-control" id="date" value="29.05.2019">

            <label class="lbl">Планируемая дата доставки С</label>
            <input type="text" name="deliveryDatePlanFrom" class="calendar form-control" id="datepicker2" value="17.05.2019 15:05:00">

            <label class="lbl">Планируемая дата доставки По</label>
            <input type="text" name="deliveryDatePlanTo" class="calendar form-control" id="datepicker2" value="17.05.2019 15:05:00">

            <div class="route">
                <label class="lbl route-lbl">Маршрут</label>
                <input type="button" name="deliveryDateTo" class="add-route-point btn btn-xs btn-default" value="+">
            </div>

            <label class="lbl shipping-place-lbl">Место погрузки</label>
            <input type="text" name="shippingPlace" class="form-control">

            <label class="lbl">Место доставки</label>
            <input type="text" name="deliveryPlace" class="form-control">
        </div>
        <div class="right-column col-lg-6">
            <label class="lbl">Организация</label>
            <select class="form-control" name="organizationId" id="organizationId">
                    <option value="21">Организация 3</option>
                    <option value="22">Организация 4</option>
                    <option value="23">foo</option>
                    <option value="24">Организация 3</option>
                    <option value="25">Организация 4</option>
                    <option value="26">ТН-Строительные системы</option>
                    <option value="27">ТН-xxx</option>
                    <option value="28">ТН-Строительные системы</option>
                    <option value="29">ТН-xxx</option>
                    <option value="30">ТН-Строительные системы</option>
                    <option value="31">ТН-xxx</option>
                    <option value="32">ТН-Строительные системы</option>
                    <option value="33">ТН-xxx</option>
                    <option value="34">ТН-Строительные системы</option>
                    <option value="35">ТН-xxx</option>
                    <option value="36">ТН-Строительные системы</option>
                    <option value="37">ТН-xxx</option>
                    <option value="38">ТН-Строительные системы</option>
                    <option value="39">ТН-xxx</option>
                    <option value="40">ТН-Строительные системы</option>
                    <option value="41">ТН-xxx</option>
                    <option value="42">ТН-Строительные системы</option>
                    <option value="43">ТН-xxx</option>
                    <option value="44">ТН-Строительные системы</option>
                    <option value="45">ТН-xxx</option>
                    <option value="46">ТН-Строительные системы</option>
                    <option value="47">ТН-xxx</option>
                    <option value="48">ТН-Строительные системы</option>
                    <option value="49">ТН-xxx</option>
                    <option value="50">ТН-Строительные системы</option>
                    <option value="51">ТН-xxx</option>
                    <option value="52">ТН-Строительные системы</option>
                    <option value="53">ТН-xxx</option>
                    <option value="54">ТН-Строительные системы</option>
                    <option value="55">ТН-xxx</option>
                    <option value="56">ТН-Строительные системы</option>
                    <option value="57">ТН-xxx</option>
                    <option value="58">ТН-Строительные системы</option>
                    <option value="59">ТН-xxx</option>
                    <option value="60">ТН-Строительные системы</option>
                    <option value="61">ТН-xxx</option>
                    <option value="62">ТН-Строительные системы</option>
                    <option value="63">ТН-xxx</option>
                    <option value="64">ТН-Строительные системы</option>
                    <option value="65">ТН-xxx</option>
                    <option value="66">ТН-Строительные системы</option>
                    <option value="67">ТН-xxx</option>
                    <option value="68">ТН-Строительные системы</option>
                    <option value="69">ТН-xxx</option>
                    <option value="70"></option>
                    <option value="71"></option>
                    <option value="72"></option>
                    <option value="73"></option>
                    <option value="74"></option>
                    <option value="75"></option>
                    <option value="76"></option>
                    <option value="77"></option>
                    <option value="78"></option>
                    <option value="79"></option>
                    <option value="80"></option>
                    <option value="81"></option>
                    <option value="82"></option>
                    <option value="83"></option>
                    <option value="84"></option>
                    <option value="85">ТН-Строительные системы</option>
                    <option value="86">ТН-xxx</option>
                    <option value="87">ТН-Строительные системы</option>
                    <option value="88">ТН-xxx</option>
                    <option value="89">ТН-Строительные системы</option>
                    <option value="90">ТН-xxx</option>
                    <option value="91">ТН-Строительные системы</option>
                    <option value="92">ТН-xxx</option>
                    <option value="93">ТН-Строительные системы</option>
                    <option value="94">ТН-xxx</option>
                    <option value="95">ТН-Строительные системы</option>
                    <option value="96">ТН-xxx</option>
                    <option value="97">ТН-Строительные системы</option>
                    <option value="98">ТН-xxx</option>
                    <option value="99">ТН-Строительные системы</option>
                    <option value="100">ТН-xxx</option>
                    <option value="101">ТН-Строительные системы</option>
                    <option value="102">ТН-xxx</option>
                    <option value="103">ТН-Строительные системы</option>
                    <option value="104">ТН-xxx</option>
                    <option value="105">ТН-Строительные системы</option>
                    <option value="106">ТН-xxx</option>
                    <option value="107">ТН-Строительные системы</option>
                    <option value="108">ТН-xxx</option>
                    <option value="109">ТН-Строительные системы</option>
                    <option value="110">ТН-xxx</option>
                    <option value="111">ТН-Строительные системы</option>
                    <option value="112">ТН-xxx</option>
                    <option value="113">ТН-Строительные системы</option>
                    <option value="114">ТН-xxx</option>
                    <option value="115">ТН-Строительные системы</option>
                    <option value="116">ТН-xxx</option>
                    <option value="117">ТН-Строительные системы</option>
                    <option value="118">ТН-Строительные системы</option>
                    <option value="119">ТН-xxx</option>
                    <option value="120">ТН-Строительные системы</option>
                    <option value="121">ТН-xxx</option>
                    <option value="122">ТН-Строительные системы</option>
                    <option value="123">ТН-xxx</option>
                    <option value="124">ТН-Строительные системы</option>
                    <option value="125">ТН-xxx</option>
                    <option value="126">ТН-Строительные системы</option>
                    <option value="127">ТН-xxx</option>
                    <option value="128">ТН-Строительные системы</option>
                    <option value="129">ТН-xxx</option>
                    <option value="130">ТН-Строительные системы</option>
                    <option value="131">ТН-xxx</option>
                    <option value="132">ТН-Строительные системы</option>
                    <option value="133">ТН-xxx</option>
                    <option value="134">ТН-Строительные системы</option>
                    <option value="135">ТН-xxx</option>
                    <option value="136">ТН-Строительные системы</option>
                    <option value="137">ТН-xxx</option>
                    <option value="138">ТН-Строительные системы</option>
                    <option value="139">ТН-xxx</option>
                    <option value="140">ТН-Строительные системы</option>
                    <option value="141">ТН-xxx</option>
                    <option value="142">ТН-Строительные системы</option>
                    <option value="143">ТН-xxx</option>
                    <option value="144">ТН-Строительные системы</option>
                    <option value="145">ТН-xxx</option>
                    <option value="146">ТН-Строительные системы</option>
                    <option value="147">ТН-xxx</option>
                    <option value="148">ТН-Строительные системы</option>
                    <option value="149">ТН-xxx</option>
                    <option value="150">ТН-Строительные системы</option>
                    <option value="151">ТН-xxx</option>
            </select>

            <label class="lbl">Тип ТС</label>
            <select class="form-control" name="vehicleTypeId" id="vehicleTypeId">
                    <option value="190">легковой</option>
                    <option value="191">10 т тент 82м3</option>
                    <option value="192">20 т тент 82м3</option>
            </select>

            <label class="lbl">Тип загрузки</label>
            <select class="form-control" name="loadingTypeId" id="loadingTypeId">
                    <option value="102">Передняя</option>
                    <option value="103">Задняя</option>
            </select>

            <label class="lbl">Тип кузова ТС</label>
            <select class="form-control" name="bodyTypeId" id="bodyTypeId">
                    <option value="102">Седан</option>
                    <option value="103">Универсал</option>
            </select>

            <label class="lbl">Вес</label>
            <input type="text" name="deliveryDate" class="form-control" id="datepicker2">
            <br>

            <a href="http://localhost:51381/Claims/Create#" class="match-shippers">Подобрать перевозчиков</a>
            <label class="lbl assign-lbl">Назначить:</label>
            <select id="" class="shippers-select form-control" name="shipperId"></select>

            <input type="button" class="assign-auto btn btn-default btn-xs" value="Распределить автоматически">
            <span class="site-suggestion" style="display: none;">Аукцион</span><br>

            <select class="trading-select form-control" name="statusId" style="display: none;">
                <option value="0">Выберите:</option>
                <option value="1">На аукцион</option>
                <option value="2">На тендер</option>
                <option value="3">По рейтингу</option>
                <option value="4">В свободный доступ</option>
            </select>
        </div>
    </div>
    <br>
    <input type="submit" class="btn btn-primary" value="Создать">
</form>

<script src="./исходный создать задание_files/jquery-3.3.1.js.Без названия"></script>
<link rel="stylesheet" href="./исходный создать задание_files/jquery-ui.css">

<script>
    // отладка
    $('input[name="number"]').val(1);
    //let d = new Date();
    //let date = d.getDate() + '.' + d.getMonth() + '.' + d.getFullYear() + ':' + d.getHours() + '.' + d.getMinutes();

    //$("#datepicker1, #datepicker2").datepicker();

    /*
    $('.add-route-point').click(function () {
        $('.shipping-place-lbl').prepend(getPointMarkup());

        $('.remove-point').click(function () {
            $(this).prev().remove();
            $(this).next().remove(); // br
            $(this).remove();
        });
    });

    function getPointMarkup() {
        return '<input type="text" name="points" class="point form-control">' +
            '<input type="button" class="remove-point btn btn-danger btn-sm" value="x"><br>';
    }*/

    $('.match-shippers').click(function () {
        let host = window.location.hostname;
        let port = window.location.port;
        let path = "http://" + host + ':' + port + "/TMSMVC/User/GetShippers";
        $.ajax({
            url: path,
            success: function (result) {
                $('.shippers-select').append('<option value=0>Выберите:</option>');
                result.forEach(function (item) {
                    $('.shippers-select').append('<option value=' + item.Id + '>' + item.Title + '</option>');
                });
            }
        })
    });

    toggleTradingUI('none');
    $('#assign-claim input').on('change', function () {
        $(".trading-select").val($(".trading-select option:first").val());
        $(".shippers-select").val($(".shippers-select option:first").val());
        let val = $('input[name=assign]:checked', '#assign-claim').val();
        if (val == 'shipper') {
            toggleShipperUI('block');
            toggleTradingUI('none');
        }
        if (val == 'trading') {
            toggleShipperUI('none');
            toggleTradingUI('block');
        }
    });

    function toggleShipperUI(displayVal) {
        $('.match-shippers, .assign-lbl, .shippers-select').css('display', displayVal);
    }

    function toggleTradingUI(displayVal) {
        $('.trading-lbl, .find-auto, .site-suggestion, .trading-select').css('display', displayVal);
    }

    function getAuctionStartPriceHtml() {
        return '<label class="trading-price lbl">Начальная цена</label>' +
            '<input class="trading-price auction-price form-control" type="text" name="auctionStartPrice">';
    }

    function getTenderStartPriceHtml() {
        return '<label class="trading-price lbl">Начальная цена</label>' +
            '<input class="trading-price tender-price form-control" type="text" name="tenderStartPrice">';
    }

    $('.trading-select').change(function () {
        var value = $('.trading-select option:selected').val();
        $('.trading-price').remove();
        switch (value) {
            case "1": $(this).after(getAuctionStartPriceHtml()); break;
            case "2": $(this).after(getTenderStartPriceHtml()); break;
        }
    });
</script>

<script type="text/javascript" src="./исходный создать задание_files/jquery-3.3.1.js.Без названия"></script>
<script type="text/javascript" defer="">
    const daysInWeek = 7;
    const days = {
        mon: 0,
        sun: 6
    };
    const monthsNumber = {
        jan: 0,
        oct: 9,
        nov: 10,
        dec: 11
    };
    const today = new Date();
    let currentYear = today.getFullYear();
    let currentMonth = today.getMonth();
    let hours = today.getHours();
    let minutes = today.getMinutes();
    let months = ['Январь', 'Февраль', 'Март', 'Апрель',
                'Май', 'Июнь', 'Июль', 'Август',
                'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'];

    $('.calendar').on('dblclick',function () {
        if($(this).prev().length == 0) 
            $('<p class="for"style="display:none;"></p>').insertBefore(this);
        if($(this).prev() != undefined && $(this).prev()[0].className != "calendar-wrapper") {
            $('<input type="text" class="hidden-input" hidden value=""/>').insertBefore(this);
            $('<div class="calendar-wrapper"></div>').insertBefore(this);
            let dateInInput = $(this).val().split('.');
            if(dateInInput[0] == '') {
                createCalendar($(this).prev(), year, currentMonth, '', hours, minutes);
            } else if(dateInInput[0] != ''){
                let input = $(this).val().split('.');
                let inputYearAndTime = input[2].split(' ');
                let inputYear = inputYearAndTime[0];
                let HourMinute = inputYearAndTime[1].split(':');
                createCalendar($(this).prev(),inputYear,input[1]-1,input[0],HourMinute[0],HourMinute[1]);
            }
            let coords = $(this).position();
            $($(this).prev()).css({ 'top': coords.top - 280 + "px", 'left': '8%'});   
        }
    });    

    function createCalendar(calendar, year, month, day, hour, minute) {
        let date = new Date(year, month);
        let table = getTable(year,month);
        //let hours = today.getHours();
        //let minutes = today.getMinutes();
        for (let i = 0; i < getDay(date); i++) table += '<td></td>';

        for (i = 0; date.getMonth() == month; i++) {
            if(date.getDate() != day) {
                table += '<td onclick="chooseDay(this)">' + date.getDate() + '</td>';
            } else if(date.getDate() == day) {
                table += '<td onclick="chooseDay(this)" class="selectedDay">' + date.getDate() + '</td>';
                let copyMonth = month + 1;
                copyMonth = (copyMonth < 10) ? '0' + copyMonth : copyMonth;
                $(calendar).prev().val(`${day}.${copyMonth}.${year}`);
            }
            if (getDay(date) % daysInWeek == days.sun) // вс, последний день - перевод строки
                table += '</tr><tr>';
            date.setDate(date.getDate() + 1);
        }
        if (getDay(date) != days.mon) {
            for (let i = getDay(date); i < daysInWeek; i++) {
                table += createCell();
            }
        }
        table += closeTable();
        $(calendar).html(table);
        $(calendar).append(fieldHours(hour));
        $(calendar).append(fieldMinutes(minute));
        $(calendar).append(SaveTime());
    }

    function chooseDay(e) {
        let yearInCaption = e.parentNode.parentNode.parentNode.parentNode.children[0].caption.innerText.split(/\n/)[1].split(' ')[1];// год из caption table
        let monthInCaption = e.parentNode.parentNode.parentNode.parentNode.children[0].caption.innerText.split(/\n/)[1].split(' ')[0];// месяц из caption table
        let currentDay = e.innerText;
        let hiddenInput = $(e.parentNode.parentNode.parentNode.parentNode).prev();
        let table = [];
        for (let i = 1; i < e.parentNode.parentNode.children.length; i++) {
            table.push(e.parentNode.parentNode.children[i]);
        }

        for (let i = 0; i < table.length; i++) {
            for (let j = 0; j < table[i].children.length; j++) {
                if (table[i].children[j].className == 'selectedDay') {
                    $(table[i].children[j]).removeClass('selectedDay');
                    $(hiddenInput).val('');
                }
            }
        }


        for(let i = 0; i < months.length; i++) {
            if(months[i] == monthInCaption) {
                monthInCaption = i + 1;
            }
        }
            
        currentDay = (currentDay < 10) ? '0' + currentDay : currentDay;
        monthInCaption = (monthInCaption < 10) ? '0' + monthInCaption : monthInCaption;
        if (!$(e).hasClass('selectedDay') && $(hiddenInput).val() == '') {
            $(e).addClass('selectedDay');
            $(hiddenInput).val(`${currentDay}.${monthInCaption}.${yearInCaption}`);
            //console.log("на добавлении " +  $(hiddenInput).val());
        } 
    }

    function saveDate(e) {
        let hour = e.parentNode.children[2].value;
        let minute = e.parentNode.children[4].value;
        if (!(hour.match(/0[0-9]/)))
            hour = (hour < 10) ? '0' + hour : hour;
        if (!(minute.match(/0[0-9]/)))
            minute = (minute < 10) ? '0' + minute : minute;
        let currentValueInput = $(e.parentNode).next();
        let hiddenInput = $(e.parentNode).prev().val();
        $(currentValueInput).val(`${hiddenInput} ${hour}:${minute}`);
        $(e.parentNode).remove();
    }

    function nextMonth(e) {
        $(e.parentNode.parentNode.parentNode).prev().val('');
        let calendarWrapper = e.parentNode.parentNode.parentNode;
        let hour = ($(calendarWrapper).next()[0].value != '')? $(calendarWrapper).next()[0].value.split(' ')[1].split(':')[0] : today.getHours();
        let minute = ($(calendarWrapper).next()[0].value != '')? $(calendarWrapper).next()[0].value.split(' ')[1].split(':')[1] : today.getMinutes();
            $(calendarWrapper).empty();
            if (currentMonth >= 0 && currentMonth <= 11) {
                currentMonth++;
                if (currentMonth != 12) 
                    createCalendar(calendarWrapper, currentYear, currentMonth,'',hour,minute);
            }
            if (currentMonth == -1 || currentMonth == 0) {
                currentMonth = 11;
                createCalendar(calendarWrapper, currentYear, currentMonth,'',hour,minute);
            }
            if (currentMonth == 12) {
                currentMonth = 0;
                currentYear++;
                createCalendar(calendarWrapper, currentYear, currentMonth,'',hour,minute);
            }
        }

    function previousMonth(e) {
        $(e.parentNode.parentNode.parentNode).prev().val('');
        let calendarWrapper = e.parentNode.parentNode.parentNode;
        let hour = ($(calendarWrapper).next()[0].value != '')? $(calendarWrapper).next()[0].value.split(' ')[1].split(':')[0] : today.getHours();
        let minute = ($(calendarWrapper).next()[0].value != '')? $(calendarWrapper).next()[0].value.split(' ')[1].split(':')[1] : today.getMinutes();
        $(calendarWrapper).empty();
        if (currentMonth >= 0 && currentMonth <= 11) {
            currentMonth--;
            if (currentMonth != -1)
                createCalendar(calendarWrapper, currentYear, currentMonth, '', hour, minute);
        }
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
            createCalendar(calendarWrapper, currentYear, currentMonth, '', hour, minute);
        }
    }

    function getTable(year,month) {
        return '<table>' +
                    '<caption>' +
                        '<span class="previousMonth" onclick=previousMonth(this)> < </span>' +
                        '<span class="calendar-wrapper-date">' + months[month] + ' ' + year + '</span>' +
                        '<span class="nextMonth" onclick=nextMonth(this)>></span>' +
                    '</caption>' +
                    '<tr>' +
                        '<th>пн</th>' +
                        '<th>вт</th>' +
                        '<th>ср</th>' +
                        '<th>чт</th>' +
                        '<th>пт</th>' +
                        '<th>сб</th>' +
                        '<th>вс</th>' +
                    '</tr>' +
                    '<tr>';
    }

    function getDay(date) {
        let day = date.getDay();
        if (day == 0) day = 7;
        return day - 1;
    }

    let closeTable = () => '</tr></table>';

    let createCell = () => '<td></td>';

    let fieldHours = (hour) =>  `<span>Час</span><input type = "number" min="0" max="23" class = "time hours" placeholder = "Час" value = ${hour} />`;
    let fieldMinutes = (minute) =>  `<span>Мин</span><input type = "number" min="0" max="60" class = "time minutes" placeholder = "Мин" value = ${minute} />`;
    let SaveTime = () => '<button class="ok" onclick=saveDate(this)>OK</button>';
</script>
        <hr>
        <footer>
            <p>© 2019 – приложение ASP.NET</p>
        </footer>
    </div>

    <script src="./исходный создать задание_files/jquery-3.3.1.js(1).Без названия"></script>

    <script src="./исходный создать задание_files/script.js.Без названия"></script>

    


</body></html>